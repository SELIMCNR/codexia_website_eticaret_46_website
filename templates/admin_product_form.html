{% extends "base.html" %}
{% block title %}Ürün Formu{% endblock %}
{% block content %}
<h2 class="mb-4 text-primary">
  <i class="fas fa-edit me-2"></i> Ürün {{ product and 'Düzenle' or 'Ekle' }}
</h2>

<form method="POST" enctype="multipart/form-data" class="card shadow-sm p-4">
  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

  <!-- Ad -->
  <div class="mb-3">
    <label class="form-label fw-bold">Ad</label>
    <input type="text" name="name" class="form-control"
           value="{{ product.name if product else '' }}" required>
  </div>

  <!-- Fiyat -->
  <div class="mb-3">
    <label class="form-label fw-bold">Fiyat</label>
    <input type="number" step="0.01" name="price" class="form-control"
           value="{{ product.price if product else '' }}" required>
  </div>

  <!-- Stok -->
  <div class="mb-3">
    <label class="form-label fw-bold">Stok</label>
    <input type="number" name="stock" class="form-control"
           value="{{ product.stock if product else 0 }}">
  </div>

  <!-- SKU -->
  <div class="mb-3">
    <label class="form-label fw-bold">SKU</label>
    <input type="text" name="sku" class="form-control"
           value="{{ product.sku if product else '' }}">
  </div>

  <!-- Marka -->
  <div class="mb-3">
    <label class="form-label fw-bold">Marka</label>
    <input type="text" name="brand" class="form-control"
           value="{{ product.brand if product else '' }}">
  </div>

  <!-- İndirim -->
  <div class="mb-3">
    <label class="form-label fw-bold">İndirim (%)</label>
    <input type="number" name="discount" min="0" max="100" class="form-control"
           value="{{ product.discount if product else 0 }}">
  </div>

  <!-- Durum -->
  <div class="mb-3">
    <label class="form-label fw-bold">Durum</label>
    <select name="is_active" class="form-select">
      <option value="1" {% if product and product.is_active %}selected{% endif %}>Aktif</option>
      <option value="0" {% if product and not product.is_active %}selected{% endif %}>Pasif</option>
    </select>
  </div>

  <!-- Kategori -->
  <div class="mb-3">
    <label class="form-label fw-bold">Kategori</label>
    <select name="category_id" class="form-select" required>
      {% for c in categories %}
      <option value="{{ c.id }}"
        {% if product and product.category_id == c.id %}selected{% endif %}>
        {{ c.name }}
      </option>
      {% endfor %}
    </select>
  </div>

  <!-- Kampanya -->
  <div class="mb-3">
    <label class="form-label fw-bold">Kampanya</label>
    <select name="campaign_id" class="form-select">
      <option value="">-- Kampanya Yok --</option>
      {% for camp in campaigns %}
      <option value="{{ camp.id }}"
        {% if product and product.campaign_id == camp.id %}selected{% endif %}>
        {{ camp.title }} (%{{ camp.discount }})
      </option>
      {% endfor %}
    </select>
  </div>

  <!-- Açıklama -->
  <div class="mb-3">
    <label class="form-label fw-bold">Açıklama</label>
    <textarea name="description" class="form-control" rows="4">{{ product.description if product else '' }}</textarea>
  </div>

  <!-- Kargo Bilgisi -->
  <div class="mb-3">
    <label class="form-label fw-bold">Kargo Bilgisi</label>
    <input type="text" name="shipping_info" class="form-control"
           value="{{ product.shipping_info if product else '' }}">
  </div>

  <!-- Ağırlık -->
  <div class="mb-3">
    <label class="form-label fw-bold">Ağırlık (kg)</label>
    <input type="number" step="0.01" name="weight" class="form-control"
           value="{{ product.weight if product else '' }}">
  </div>

  <!-- Boyutlar -->
  <div class="mb-3">
    <label class="form-label fw-bold">Boyutlar</label>
    <input type="text" name="dimensions" class="form-control"
           value="{{ product.dimensions if product else '' }}">
  </div>

  <!-- Garanti -->
  <div class="mb-3">
    <label class="form-label fw-bold">Garanti Süresi</label>
    <input type="text" name="warranty" class="form-control"
           value="{{ product.warranty if product else '' }}">
  </div>

  <!-- Tedarikçi -->
  <div class="mb-3">
    <label class="form-label fw-bold">Tedarikçi</label>
    <input type="text" name="supplier" class="form-control"
           value="{{ product.supplier if product else '' }}">
  </div>

  <!-- SEO Slug -->
  <div class="mb-3">
    <label class="form-label fw-bold">Slug (SEO URL)</label>
    <input type="text" name="slug" class="form-control"
           value="{{ product.slug if product else '' }}">
  </div>

  <!-- SEO Title -->
  <div class="mb-3">
    <label class="form-label fw-bold">SEO Başlığı</label>
    <input type="text" name="seo_title" class="form-control"
           value="{{ product.seo_title if product else '' }}">
  </div>

  <!-- SEO Description -->
  <div class="mb-3">
    <label class="form-label fw-bold">SEO Açıklaması</label>
    <textarea name="seo_description" class="form-control" rows="2">{{ product.seo_description if product else '' }}</textarea>
  </div>

  <!-- Etiketler -->
  <div class="mb-3">
    <label class="form-label fw-bold">Etiketler (virgülle ayır)</label>
    <input type="text" name="tags" class="form-control"
           value="{{ product.tags if product else '' }}">
  </div>

  <!-- Özellikler -->
  <div class="mb-3">
    <label class="form-label fw-bold">Özellikler</label>
    <textarea name="features" class="form-control" rows="3">{{ product.features if product else '' }}</textarea>
  </div>

  <!-- Varyantlar -->
  <div class="mb-3">
    <label class="form-label fw-bold">Varyantlar</label>
    <textarea name="variants" class="form-control" rows="2">{{ product.variants if product else '' }}</textarea>
  </div>

  <!-- Görsel -->
  <div class="mb-3">
    <label class="form-label fw-bold">Ürün Görseli</label>
    <input type="file" name="image" class="form-control" accept="image/*">
    {% if product and product.image_url %}
      <div class="mt-2">
        <img src="{{ url_for('static', filename=product.image_url) }}" alt="Ürün Görseli"
             class="img-thumbnail" style="max-height:150px;">
      </div>
    {% endif %}
  </div>

  <div class="d-flex justify-content-between">
    <button type="submit" class="btn btn-success">
      <i class="fas fa-save me-1"></i> Kaydet
    </button>
    <a href="{{ url_for('admin_products') }}" class="btn btn-secondary">
      <i class="fas fa-times me-1"></i> İptal
    </a>
  </div>
</form>
{% endblock %}